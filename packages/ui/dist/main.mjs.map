{"version":3,"file":"main.mjs","sources":["../../resource-loader/src/main.mjs","../src/main.mjs"],"sourcesContent":["// @ts-nocheck\nfunction setAttributes (element, attributes) {\n  if (attributes) {\n    Object.keys(attributes).forEach(k => {\n      element.setAttribute(k, attributes[k])\n    })\n  }\n}\n\nfunction getCacheBuster (cache = true) {\n  return cache ? '' : `?${Date.now()}`\n}\n\nfunction createScript (url, attributes = null, cache = true) {\n  const script = document.createElement('script')\n  script.setAttribute('type', 'text/javascript')\n  script.setAttribute('src', `${url}${getCacheBuster(cache)}`)\n  setAttributes(script, attributes)\n  return script\n}\n\nfunction createStyleLink (url, attributes = null, cache = true) {\n  const style = document.createElement('link')\n  style.setAttribute('rel', 'stylesheet')\n  style.setAttribute('type', 'text/css')\n  style.setAttribute('href', `${url}${getCacheBuster(cache)}`)\n  setAttributes(style, attributes)\n  return style\n}\n\nfunction createPromise (dep) {\n  if (!dep.url || !dep.is) {\n    return Promise.reject(new Error('No url or type given!'))\n  }\n\n  if (!window.__ficusjs__.resources[dep.url]) {\n    // create a promise to load the resource\n    const promise = new Promise((resolve, reject) => {\n      const handleResponse = (e) => {\n        if (e.error || (e.type && e.type === 'error')) {\n          reject(e.error)\n        } else {\n          window.__ficusjs__.resources[dep.url].hasLoaded = true\n          resolve()\n        }\n      }\n\n      if (dep.is === 'script') {\n        const script = createScript(dep.url, dep.attributes, dep.cache)\n        script.onerror = handleResponse\n        script.onload = handleResponse\n        document.body.appendChild(script)\n      } else if (dep.is === 'style') {\n        const style = createStyleLink(dep.url, dep.attributes, dep.cache)\n        style.onerror = handleResponse\n        style.onload = handleResponse\n        document.getElementsByTagName('head')[0].appendChild(style)\n      }\n    })\n    window.__ficusjs__.resources[dep.url] = { type: dep.is, hasLoaded: false, promise }\n    return promise\n  } else {\n    return window.__ficusjs__.resources[dep.url].promise\n  }\n}\n\n/**\n * Function to load one or more external resources\n * @param {...object|Array} items The resources to load\n * @returns {Promise} A pending promise\n * @example\n * loadResource(\n *   { url: '/css/label.css', is: 'style' },\n *   { url: '/js/label.iife.js', is: 'script', cache: false },\n *   { url: '/js/label.esm.js', is: 'script', attributes: { type: 'module' } },\n * )\n */\nexport function loadResource (...items) {\n  window.__ficusjs__ = window.__ficusjs__ || {}\n  window.__ficusjs__.resources = window.__ficusjs__.resources || {}\n  if (!items.length) return Promise.resolve()\n  const promises = items.map(x => {\n    return createPromise(x)\n  })\n  return Promise.allSettled(promises)\n}\n","// @ts-nocheck\n/* global HTMLElement */\nimport { loadResource } from '@ficusjs/resource-loader'\n\nfunction html (strings) {\n  return elementFromString(strings.raw[0])\n}\n\nfunction elementFromString (html) {\n  const div = document.createElement('div')\n  div.innerHTML = html.trim()\n  return div.firstChild\n}\n\nfunction createComponents (config) {\n  class FicusAppShell extends HTMLElement {\n    connectedCallback () {\n      if (!this.classList.contains(config.appTagName)) {\n        this.classList.add(config.appTagName)\n\n        // perform a media query on the screen width to determine whether to write out the mobile or desktop app shell component\n        const mql = window.matchMedia(config.desktopMediaQuery)\n        let tagName = config.mobileUiTagName\n        let scriptUrl = config.mobileUiScriptUrl\n        if (mql.matches) {\n          tagName = config.desktopUiTagName\n          scriptUrl = config.desktopUiScriptUrl\n        }\n\n        // append the app shell component\n        this.appendChild(elementFromString(`<${tagName}></${tagName}>`))\n\n        // append the script to load the app shell UI components\n        loadResource({ url: scriptUrl, is: 'script', attributes: { type: 'module' } })\n      }\n    }\n  }\n\n  class FicusMobileAppShell extends HTMLElement {\n    connectedCallback () {\n      if (!this.classList.contains(config.mobileUiTagName)) {\n        this.classList.add(config.mobileUiTagName)\n        this.appendChild(html`<div>\n          <fas-mobile-header></fas-mobile-header>\n          <fas-mobile-nav></fas-mobile-nav>\n          <main id=\"router-outlet\"></main>\n          <fas-mobile-footer></fas-mobile-footer>\n        </div>`)\n      }\n    }\n  }\n\n  class FicusDesktopAppShell extends HTMLElement {\n    connectedCallback () {\n      if (!this.classList.contains(config.desktopUiTagName)) {\n        this.classList.add(config.desktopUiTagName)\n        this.appendChild(html`<div>\n          <fas-desktop-header></fas-desktop-header>\n          <fas-desktop-nav></fas-desktop-nav>\n          <main>\n            <div id=\"router-outlet\"></div>\n            <fas-desktop-aside></fas-desktop-aside>\n          </main>\n          <fas-desktop-footer></fas-desktop-footer>\n        </div>`)\n      }\n    }\n  }\n\n  // register the root app component\n  window.customElements.get(config.appTagName) || window.customElements.define(config.appTagName, FicusAppShell)\n\n  // register the mobile shell component\n  window.customElements.get(config.mobileUiTagName) || window.customElements.define(config.mobileUiTagName, FicusMobileAppShell)\n\n  // register the desktop shell component\n  window.customElements.get(config.desktopUiTagName) || window.customElements.define(config.desktopUiTagName, FicusDesktopAppShell)\n}\n\nexport function createAppShellComponents (options) {\n  const defaultConfig = {\n    // root app tag\n    appTagName: 'fas-app',\n\n    // breakpoint at which to switch from mobile to desktop\n    desktopMediaQuery: '(min-width: 1280px)',\n\n    // should the breakpoint be reactive on resize?\n    reactive: false,\n\n    // desktop shell ui components\n    desktopUiTagName: 'fas-ui-desktop',\n    desktopUiScriptUrl: '/app-ui-desktop/main.mjs',\n\n    // mobile shell ui components\n    mobileUiTagName: 'fas-ui-mobile',\n    mobileUiScriptUrl: '/app-ui-mobile/main.mjs'\n  }\n  const config = { ...defaultConfig, ...options }\n  createComponents(config)\n}\n"],"names":["setAttributes","element","attributes","Object","keys","forEach","k","setAttribute","getCacheBuster","cache","Date","now","createPromise","dep","url","is","Promise","reject","Error","window","__ficusjs__","resources","promise","resolve","handleResponse","e","error","type","hasLoaded","script","document","createElement","createScript","onerror","onload","body","appendChild","style","createStyleLink","getElementsByTagName","html","strings","elementFromString","raw","div","innerHTML","trim","firstChild","createComponents","config","FicusAppShell","HTMLElement","connectedCallback","this","classList","contains","appTagName","add","mql","matchMedia","desktopMediaQuery","tagName","mobileUiTagName","scriptUrl","mobileUiScriptUrl","matches","desktopUiTagName","desktopUiScriptUrl","items","length","promises","map","x","allSettled","loadResource","FicusMobileAppShell","FicusDesktopAppShell","customElements","get","define","createAppShellComponents","options","reactive"],"mappings":"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"}