{"version":3,"file":"main.mjs","sources":["../src/main.mjs"],"sourcesContent":["// @ts-nocheck\nfunction setAttributes (element, attributes) {\n  if (attributes) {\n    Object.keys(attributes).forEach(k => {\n      element.setAttribute(k, attributes[k])\n    })\n  }\n}\n\nfunction getCacheBuster (cache = true) {\n  return cache ? '' : `?${Date.now()}`\n}\n\nfunction createScript (url, attributes = null, cache = true) {\n  const script = document.createElement('script')\n  script.setAttribute('type', 'text/javascript')\n  script.setAttribute('src', `${url}${getCacheBuster(cache)}`)\n  setAttributes(script, attributes)\n  return script\n}\n\nfunction createStyleLink (url, attributes = null, cache = true) {\n  const style = document.createElement('link')\n  style.setAttribute('rel', 'stylesheet')\n  style.setAttribute('type', 'text/css')\n  style.setAttribute('href', `${url}${getCacheBuster(cache)}`)\n  setAttributes(style, attributes)\n  return style\n}\n\nfunction createPromise (dep) {\n  if (!dep.url || !dep.is) {\n    return Promise.reject(new Error('No url or type given!'))\n  }\n\n  if (!window.__ficusjs__.resources[dep.url]) {\n    // create a promise to load the resource\n    const promise = new Promise((resolve, reject) => {\n      const handleResponse = (e) => {\n        if (e.error || (e.type && e.type === 'error')) {\n          reject(e.error)\n        } else {\n          window.__ficusjs__.resources[dep.url].hasLoaded = true\n          resolve()\n        }\n      }\n\n      if (dep.is === 'script') {\n        const script = createScript(dep.url, dep.attributes, dep.cache)\n        script.onerror = handleResponse\n        script.onload = handleResponse\n        document.body.appendChild(script)\n      } else if (dep.is === 'style') {\n        const style = createStyleLink(dep.url, dep.attributes, dep.cache)\n        style.onerror = handleResponse\n        style.onload = handleResponse\n        document.getElementsByTagName('head')[0].appendChild(style)\n      }\n    })\n    window.__ficusjs__.resources[dep.url] = { type: dep.is, hasLoaded: false, promise }\n    return promise\n  } else {\n    return window.__ficusjs__.resources[dep.url].promise\n  }\n}\n\n/**\n * Function to load one or more external resources\n * @param {...object|Array} items The resources to load\n * @returns {Promise} A pending promise\n * @example\n * loadResource(\n *   { url: '/css/label.css', is: 'style' },\n *   { url: '/js/label.iife.js', is: 'script', cache: false },\n *   { url: '/js/label.esm.js', is: 'script', attributes: { type: 'module' } },\n * )\n */\nexport function loadResource (...items) {\n  window.__ficusjs__ = window.__ficusjs__ || {}\n  window.__ficusjs__.resources = window.__ficusjs__.resources || {}\n  if (!items.length) return Promise.resolve()\n  const promises = items.map(x => {\n    return createPromise(x)\n  })\n  return Promise.allSettled(promises)\n}\n"],"names":["setAttributes","element","attributes","Object","keys","forEach","k","setAttribute","getCacheBuster","cache","Date","now","createPromise","dep","url","is","Promise","reject","Error","window","__ficusjs__","resources","promise","resolve","handleResponse","e","error","type","hasLoaded","script","document","createElement","createScript","onerror","onload","body","appendChild","style","createStyleLink","getElementsByTagName","loadResource","items","length","promises","map","x","allSettled"],"mappings":"AACA,SAASA,cAAeC,EAASC,GAC3BA,GACFC,OAAOC,KAAKF,GAAYG,SAAQC,IAC9BL,EAAQM,aAAaD,EAAGJ,EAAWI,GAAG,GAG5C,CAEA,SAASE,eAAgBC,GAAQ,GAC/B,OAAOA,EAAQ,GAAK,IAAIC,KAAKC,OAC/B,CAmBA,SAASC,cAAeC,GACtB,IAAKA,EAAIC,MAAQD,EAAIE,GACnB,OAAOC,QAAQC,OAAO,IAAIC,MAAM,0BAGlC,GAAKC,OAAOC,YAAYC,UAAUR,EAAIC,KA2BpC,OAAOK,OAAOC,YAAYC,UAAUR,EAAIC,KAAKQ,QA3BH,CAE1C,MAAMA,EAAU,IAAIN,SAAQ,CAACO,EAASN,KACpC,MAAMO,eAAkBC,IAClBA,EAAEC,OAAUD,EAAEE,MAAmB,UAAXF,EAAEE,KAC1BV,EAAOQ,EAAEC,QAETP,OAAOC,YAAYC,UAAUR,EAAIC,KAAKc,WAAY,EAClDL,IACD,EAGH,GAAe,WAAXV,EAAIE,GAAiB,CACvB,MAAMc,EAnCd,SAAuBf,EAAKZ,EAAa,KAAMO,GAAQ,GACrD,MAAMoB,EAASC,SAASC,cAAc,UAItC,OAHAF,EAAOtB,aAAa,OAAQ,mBAC5BsB,EAAOtB,aAAa,MAAO,GAAGO,IAAMN,eAAeC,MACnDT,cAAc6B,EAAQ3B,GACf2B,CACT,CA6BuBG,CAAanB,EAAIC,IAAKD,EAAIX,WAAYW,EAAIJ,OACzDoB,EAAOI,QAAUT,eACjBK,EAAOK,OAASV,eAChBM,SAASK,KAAKC,YAAYP,EAClC,MAAa,GAAe,UAAXhB,EAAIE,GAAgB,CAC7B,MAAMsB,EAhCd,SAA0BvB,EAAKZ,EAAa,KAAMO,GAAQ,GACxD,MAAM4B,EAAQP,SAASC,cAAc,QAKrC,OAJAM,EAAM9B,aAAa,MAAO,cAC1B8B,EAAM9B,aAAa,OAAQ,YAC3B8B,EAAM9B,aAAa,OAAQ,GAAGO,IAAMN,eAAeC,MACnDT,cAAcqC,EAAOnC,GACdmC,CACT,CAyBsBC,CAAgBzB,EAAIC,IAAKD,EAAIX,WAAYW,EAAIJ,OAC3D4B,EAAMJ,QAAUT,eAChBa,EAAMH,OAASV,eACfM,SAASS,qBAAqB,QAAQ,GAAGH,YAAYC,EACtD,KAGH,OADAlB,OAAOC,YAAYC,UAAUR,EAAIC,KAAO,CAAEa,KAAMd,EAAIE,GAAIa,WAAW,EAAON,WACnEA,CACX,CAGA,CAaO,SAASkB,gBAAiBC,GAG/B,GAFAtB,OAAOC,YAAcD,OAAOC,aAAe,CAAE,EAC7CD,OAAOC,YAAYC,UAAYF,OAAOC,YAAYC,WAAa,CAAE,GAC5DoB,EAAMC,OAAQ,OAAO1B,QAAQO,UAClC,MAAMoB,EAAWF,EAAMG,KAAIC,GAClBjC,cAAciC,KAEvB,OAAO7B,QAAQ8B,WAAWH,EAC5B"}