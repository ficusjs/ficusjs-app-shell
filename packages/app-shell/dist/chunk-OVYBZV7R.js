import{a as qt}from"./chunk-RPHO6JGJ.js";var M=class{constructor(){if(globalThis.__ficusjs__&&globalThis.__ficusjs__.eventBus)return globalThis.__ficusjs__.eventBus;this.subscribers={},globalThis.__ficusjs__=globalThis.__ficusjs__||{},globalThis.__ficusjs__.eventBus=globalThis.__ficusjs__.eventBus||this}getSubscribers(t){return t?this.subscribers[t]:this.subscribers}subscribe(t,e,s={}){let r=this,n={callCount:0,fireOnce:!1,...s};return r.subscribers[t]||(r.subscribers[t]=new Map),r.subscribers[t].set(e,n),()=>{let o=new Map;r.subscribers[t].forEach((a,u)=>u!==e&&o.set(u,a)),r.subscribers[t]=o}}publish(t,e){if(!this.subscribers[t])return[];let s=new Map;return this.subscribers[t].forEach((r,n)=>{r.fireOnce&&r.callCount===1||(n(e),++r.callCount,s.set(n,r))}),s}};function Vt(){return new M}function it(){return Vt()}var nt=(i=()=>!0,t=1e4)=>new Promise((e,s)=>{let r=()=>{let n=i();n?e(n):(t-=100)<0?s(new Error("Timed out waiting!")):setTimeout(r,100)};setTimeout(r,100)});function I(i){return(typeof i=="object"||typeof i=="function")&&typeof i.then=="function"}function ot(i,t){return Object.prototype.hasOwnProperty.call(i,t)}function ut(i){for(;i.firstChild;)i.removeChild(i.firstChild)}function Jt(i,t){let e=typeof t=="string"?document.querySelector(t):t;if(!e)return void console.warn(`Unable to find outlet: ${t}`);let s;(function(n){return n instanceof Element||n instanceof HTMLElement})(i)?s=i:s=window.customElements.get(i)?document.createElement(i):function(n){let o=document.createElement("div");return o.innerHTML=n.trim(),o.firstChild}(i),ut(e),e.appendChild(s);let r="data-router-outlet";e.hasAttribute(r)||e.setAttribute(r,"")}var at=class extends Array{peek(){return this[this.length-1]}};function lt(i,t,e,s=!0){e.forEach(r=>{if(r.children)(function(n,o,a){let u,c=[...a.children];if(a.action||a.component)u={...a},delete u.children;else{let h=c.find(p=>p.path==="");h&&(u={...h},u.path=a.path,delete u.children,c=c.filter(p=>p.path!==""))}let l=ct(u,o);n.push(l),o.push(l),lt(n,o,c,!1)})(i,t,r);else{let n=ct(r,t);i.push(n)}s&&t.splice(0,t.length)})}function ct(i,t){let e={...i},s=t.peek();return s&&(e.path=`${s.path}${e.path}`),e}function $(i){return i.charAt(i.length-1)==="/"?i.slice(0,-1):i}function D(i){let t={...i,matcher:e=>$(i.path)===$(e)?e:void 0};if(i.component&&!i.action&&(t.action=()=>i.component),/:[^/]+/.test(i.path)){let e=i.path.match(/(:[^/]+)/gm);e&&e.length>0&&(t.urlParamKeys=e.map(r=>r.substring(1)));let s=$(i.path.replace(/:[^/]+/g,"([^/]+)"));t.pathRegex=new RegExp(`^${s}$`),t.pathRegexCapture=new RegExp(s,"gm"),t.matcher=r=>{if(t.pathRegex.test(r)){let n={},o;for(;(o=t.pathRegexCapture.exec(r))!==null;)if(o&&o.length===t.urlParamKeys.length+1){let a=o.slice(1);for(let u=0;u<a.length;u++)n[t.urlParamKeys[u]]=a[u]}return n}}}return t}var L=class{constructor(t){let e,s;this.urlParamMap={};let r=[];t.includes("?")?(e=t.substring(t.indexOf("?")+1),e.includes("#")&&(e=e.substring(0,e.indexOf("#")),s=e.substring(e.indexOf("#")+1))):t.includes("#")&&(e="",s=t.substring(t.indexOf("#")+1,t.length)),r=e?e.split("&"):[],s&&s.includes("&")&&s.includes("=")&&(r=[...r,...s.split("&")]);for(let n=0;n<r.length;n++){let o=r[n].split("=");o.length===2&&(this.urlParamMap[o[0]]=this._esc(decodeURIComponent(o[1])))}}entries(){let t=[];for(let e in this.urlParamMap)this.has(e)&&t.push([e,this.urlParamMap[e]]);return t=t.sort(function(e,s){return e[0].toLowerCase()>s[0].toLowerCase()?1:e[0].toLowerCase()<s[0].toLowerCase()?-1:0}),t}remove(t){delete this.urlParamMap[t]}get(t){return this.urlParamMap[t]}has(t){return this.urlParamMap.hasOwnProperty(t)}keys(){let t=[];for(let e in this.urlParamMap)this.has(e)&&t.push(e);return t}set(t,e){this.urlParamMap[t]=e}toString(){let t="",e=this.entries();for(let s=0;s<e.length;s++){let r=e[s];this.has(r[0])&&(t+="&"+r[0]+"="+encodeURIComponent(this._unesc(r[1])))}return t.substring(1)}values(){let t=[];for(let e in this.urlParamMap)this.has(e)&&t.push(this.urlParamMap[e]);return t}_esc(t){return String(t).replace(/</g,"&lt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;").replace(/>/g,"&gt;").replace(/&/g,"&amp;")}_unesc(t){return String(t).replace(/&lt;/g,"<").replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&amp;/g,"&")}},U=class{constructor(){this.items=[]}push(t){this.items.push(t)}pop(){this.items.pop()}peek(){return this.items[this.items.length-1]}isEmpty(){return this.items.length===0}clear(){this.items=[]}size(){return this.items.length}},B=class{constructor(t,e,s){if(typeof window<"u"&&window.__ficusjs__&&window.__ficusjs__.router)return window.__ficusjs__.router;this._rootOutletSelector=e,this.stack=new U,this._routes=this._processRoutes(t),this._routerOptions=this._processOptions(s),this._outletCache=new WeakMap,typeof window<"u"&&(window.addEventListener("popstate",()=>{this._findAndRenderRoute(this.location).then(()=>this.stack.pop()).catch(r=>{throw this._renderError(this.location,r),r})}),window.__ficusjs__=window.__ficusjs__||{},window.__ficusjs__.router=window.__ficusjs__.router||this)}get location(){let t;return typeof window<"u"&&(t={host:window.location.host,protocol:window.location.protocol,pathname:window.location.pathname,hash:window.location.hash,href:window.location.href,search:window.location.search,state:window.history.state},this._routerOptions.mode==="hash"&&(t.pathname=this._getHashPathname(),t.hash="")),t}get options(){return this._routerOptions}setOptions(t={}){this._routerOptions=this._processOptions(t)}addRoutes(t){this._routes=[...this._routes,...this._processRoutes(t)]}hasRoute(t){return!!this._findRoute(t)}_getQueryStringParams(t){return Object.fromEntries(new L(t.href).entries())}_getUrlParams(t,e){let s=e.matcher(t.pathname);return typeof s=="string"?void 0:s}_findRoute(t){return this._routes.find(e=>e.matcher(t)!==void 0)}_getHashPathname(){let t=window.location.hash.substring(1);return t===""&&(t="/"),t}_processRoutes(t){return function(e){let s=new at;return lt(s,new at,e),s}(t).map(e=>D(e))}_processOptions(t={}){let e=this,s={mode:"history",autoStart:!0,changeHistoryState:!0,warnOnMissingOutlets:!1,...t};if(!s.resolveRoute)return{...s,resolveRoute(r,n){if(r.route&&typeof r.route.action=="function")return{template:new Promise((o,a)=>{o(r.route.action(r,n))}).catch(o=>{throw e._renderError(r.location,o),o}),outlets:r.route.outlets}}};if(s.resolveRoute){let r=s.resolveRoute;return{...s,resolveRoute:(n,o)=>r(n,o)}}return s}_render(t,e,s,r={}){return I(s)?s.then(n=>this._performRender(t,e,n,r)):this._performRender(t,e,s,r)}_performRender(t,e,s,r){return typeof s=="object"&&s.redirect?Promise.resolve(s):s instanceof Error?(this._renderError(t,s),Promise.resolve(!0)):s===!1?Promise.resolve(!1):nt(()=>document.querySelector(this._rootOutletSelector)).then(()=>{let n=document.querySelector(this._rootOutletSelector),o=Object.keys(r),a=document.querySelectorAll("[data-router-outlet]:not([sticky])");return a.length&&[...a].filter(u=>u!==n).forEach(u=>ut(u)),this._renderIntoOutlet(s,n),o.length?Promise.all(o.map(u=>nt(()=>{let c=document.querySelectorAll(u);return c.length>0&&c}).then(c=>{let l=r[u](e,e&&e.params);I(l)?l.then(h=>this._renderIntoAllOutlets(h,c)):this._renderIntoAllOutlets(l,c)}).catch(c=>this._routerOptions.warnOnMissingOutlets&&console.warn(c)))).then(()=>!0):Promise.resolve(!0)})}_renderIntoOutlet(t,e){t&&(this._isSameOutletContent(t,e)||(Jt(t,e),this._outletCache.set(e,t),this._emitRouterOutletChangeEvent(e)))}_renderIntoAllOutlets(t,e){for(let s=0;s<e.length;s++){let r=e[s];this._renderIntoOutlet(t,r)}}_emitRouterOutletChangeEvent(t){(function(e,s,r={}){let n=Object.assign({},{bubbles:!0,cancelable:!0,composed:!1},r),o=new CustomEvent(s,n);e.dispatchEvent(o)})(t,"outlet-change",{detail:{outlet:t}})}_isSameOutletContent(t,e){return!(typeof t!="string"||!this._outletCache.has(e)||this._outletCache.get(e)!==t)}push(t,e){return this._navigate(t,e)}replace(t,e){return this._navigate(t,e,!0)}_navigate(t,e,s=!1){let r=this._normalizeLocation(t);if(!s&&r.pathname===this.location.pathname)return Promise.resolve();let{actionResult:n,context:o}=this._resolveRoute(r);if(n==null){this._routerOptions.changeHistoryState&&this._setState(r.href,e,s);let a=new Error("not_found");return this._renderError(r,a),Promise.reject(a)}if(typeof n=="object"&&n.redirect){let a={from:t};return n.redirect!==this.location.pathname?this.push(n.redirect,a):Promise.resolve()}return n instanceof Error?(this._routerOptions.changeHistoryState&&this._setState(r.href,e,s),this._renderError(r,n),Promise.reject(n)):n===!1?Promise.resolve():this._renderActionResult(r,o,n,e,s).then(a=>{if(typeof a=="object"&&a.redirect){let u={from:r.href};return this.push(a.redirect,u)}return a&&this._routerOptions.changeHistoryState&&this._setState(r.href,e,s),Promise.resolve(a)}).catch(a=>{throw this._renderError(r,a),a})}_normalizeLocation(t){let e={host:void 0,protocol:void 0,href:void 0,pathname:void 0,search:void 0,hash:void 0};if(typeof t=="object"){if(this._routerOptions.mode==="history"&&!t.pathname)throw new Error(`Unable to navigate to: ${t}`);let s=t.href||this.location.href;e.pathname=t.pathname||this.location.pathname,t.search&&t.search!==""&&!s.includes(t.search)&&(s=`${s}${t.search}`,e.search=t.search),t.hash&&t.hash!==""&&!s.includes(t.hash)&&(s=`${s}${t.hash}`,e.hash=t.hash),e.hash=t.hash||this.location.hash,e.search=t.search||this.location.search,e.host=t.host||this.location.host,e.protocol=t.protocol||this.location.protocol,e.href=s}else if(typeof t=="string"){let s=new URL(/^https?:\/\//.test(t)?t:`${window.location.protocol}//${window.location.host}${t}`);e.host=s.host,e.protocol=s.protocol,e.href=s.href,e.pathname=s.pathname,e.search=s.search,e.hash=s.hash,t.includes("?")?(e.pathname=t.substring(0,t.indexOf("?")),e.search=t.substring(t.indexOf("?"))):t.includes("#")&&(e.pathname=t.substring(0,t.indexOf("#")))}return this._routerOptions.mode==="hash"&&(e.href=`${window.location.pathname}${e.search||""}#${e.pathname}`),e}_renderActionResult(t,e,s){if(ot(s,"template")&&ot(s,"outlets")){let{template:r,outlets:n}=s;return this._render(t,e,r,n)}return this._render(t,e,s,{})}_getRouteContext(t,e){let s={...this._getQueryStringParams(e)},r={context:this._routerOptions.context,router:this,route:t,location:e,params:s};return t&&(s={...s,...this._getUrlParams(e,t)},r.params=s),r}_resolveRoute(t){let e=this._findRoute(t.pathname),s=this._getRouteContext(e,t);try{let r=this._routerOptions.resolveRoute(s,s.params);return r!=null?{actionResult:r,context:s}:e?{actionResult:e.action(s,s.params),context:s}:{actionResult:void 0,context:s}}catch(r){throw this._renderError(t,r),r}}_findAndRenderRoute(t){let{actionResult:e,context:s}=this._resolveRoute(t);if(!e)throw new Error("not_found");return this._renderActionResult(t,s,e)}_setState(t,e,s=!1){s?window.history.replaceState(e,null,t):(this.stack.push(t),window.history.pushState(e,null,t))}_renderError(t,e){if(console.error(`A router error occurred for location '${t.href}'`,e),this._routerOptions.errorHandler){let s={message:e.message,status:e.message==="not_found"?404:500},r=this._getRouteContext(this._findRoute(t.pathname),t),n=this._routerOptions.errorHandler(s,r);I(n)?n.then(o=>this._render(t,r,o)).catch(o=>this._render(t,r,`<div><strong>Router error from <code>errorHandler</code></strong>: ${o.message}, original error: ${e.message}</div>`)):this._render(t,r,n)}else this._render(t,null,`<div><strong>Router error</strong>: ${e.message}</div>`)}go(t){window.history.go(t)}goBack(){this.go(-1)}goForward(){this.go(1)}start(t=this.location){/complete|interactive|loaded/.test(document.readyState)?this.replace(t):document.addEventListener("DOMContentLoaded",()=>this.replace(t))}};function ye(i,t,e={}){let s=new B(i,t,e);return s.options.autoStart&&s.start(),s}function ht(){if(typeof window<"u"&&window.__ficusjs__&&window.__ficusjs__.router)return window.__ficusjs__.router}var z=class{constructor(t,e,s={}){this.namespace=t,this.storage=e,this.options=s,this._init()}_init(){if("performance"in globalThis&&this.options.clearOnReload){let t=globalThis.performance.getEntriesByType("navigation").map(e=>e.type);this.lastUpdated()&&t.includes("reload")&&this.removeState()}}setState(t){t?(this.storage.setItem(`${this.namespace}:state`,this._normalizeState(t)),this.storage.setItem(`${this.namespace}:lastUpdated`,new Date().getTime().toString())):this.removeState()}_normalizeState(t){return typeof t=="object"&&this.options.saveState&&typeof this.options.saveState=="function"?JSON.stringify(this.options.saveState(t)):typeof t!="string"?JSON.stringify(t):t}getState(){let t=this.storage.getItem(`${this.namespace}:state`);return t?JSON.parse(t):void 0}lastUpdated(){let t=this.storage.getItem(`${this.namespace}:lastUpdated`);return t?parseInt(t,10):void 0}removeState(){this.storage.removeItem(`${this.namespace}:state`),this.storage.removeItem(`${this.namespace}:lastUpdated`)}};function O(i,t="session",e){return new z(i,t==="local"?globalThis.localStorage:globalThis.sessionStorage,e)}function mt(i,t){return{...t,created(){this._subscribeCallback=()=>{this.computedCache={},this._processRender()},this.setStore(i),t.created&&t.created.call(this)},mounted(){this._subscribeToStores(!1),t.mounted&&t.mounted.call(this)},updated(){this._subscribeToStores(!1),t.updated&&t.updated.call(this)},removed(){this._unsubscribeFromStores(),t.removed&&t.removed.call(this)},setStore(e){this.store=e,this._subscribeToStores()},_subscribeToStores(e=!0){this.store&&this.store.subscribe&&typeof this.store.subscribe=="function"&&!this.unsubscribe?(this.unsubscribe=this.store.subscribe(this._subscribeCallback),e&&this._subscribeCallback()):this.store&&typeof this.store=="object"&&!this.store.subscribe&&(this.unsubscribe={},Object.keys(this.store).forEach(s=>{this.store[s]&&this.store[s].subscribe&&typeof this.store[s].subscribe=="function"&&!this.unsubscribe[s]&&(this.unsubscribe[s]=this.store[s].subscribe(this._subscribeCallback))}),e&&this._subscribeCallback())},_unsubscribeFromStores(){this.store&&this.unsubscribe&&typeof this.unsubscribe=="object"?(Object.keys(this.unsubscribe).forEach(e=>{this.unsubscribe[e]()}),this.unsubscribe=null):this.store&&this.unsubscribe&&typeof this.unsubscribe=="function"&&(this.unsubscribe(),this.unsubscribe=null)}}}function gt(i){return(typeof i=="object"||typeof i=="function")&&typeof i.then=="function"}var H=class{constructor(t){let e=this;e.state={},e.getterCache={},e.status="resting",e.transaction=!1,e.transactionCache={},e.callbacks=[],this._processActions(t);let s=t.initialState||{};if(e.copyOfInitialState=e._copyValue(s),e.ttl=-1,e.lastUpdatedState={},t.ttl&&(e.ttl=t.ttl,Object.keys(e.copyOfInitialState).forEach(r=>e.lastUpdatedState[r]=new Date().getTime())),e.persist=void 0,t.persist){e.persist=typeof t.persist=="string"?O(t.persist):t.persist;let r=e.persist.getState(),n=e.persist.lastUpdated();r&&n&&(e.ttl===-1||e._lastUpdatedTimeDiff(n)<e.ttl)&&(s=r)}this._processState(s)}_processActions(t){let e=this,s=Object.keys(t);s.length&&s.forEach(r=>{e[r]||typeof t[r]!="function"||(e[r]=t[r].bind(e))})}_processState(t){let e=this;e.state=new Proxy(t,{set:(s,r,n)=>(e.transaction&&!e.transactionCache[r]&&(e.transactionCache[r]=e._copyValue(s[r])),s[r]=n,e.lastUpdatedState[r]=new Date().getTime(),e.getterCache={},e.transaction||(e.persist&&e.persist.setState(e.state),e.status="resting",e._processCallbacks(e.state)),!0),get:(s,r)=>e.ttl>-1&&e._lastUpdatedTimeDiff(e.lastUpdatedState[r])>e.ttl?(e.persist&&e.persist.removeState(),e.copyOfInitialState[r]):s[r]})}_lastUpdatedTimeDiff(t){return Math.round(new Date().getTime()-t)}setState(t){let e=r=>{if(!r||typeof r!="object")return;let n=this.transaction;n||(this.transactionCache={},this.transaction=!0);for(let o in r)this.state[o]&&this.state[o]===r[o]||(this.state[o]=r[o]);n||(this.transaction=!1,this.persist&&this.persist.setState(this.state),this._processCallbacks(this.state))},s=t(this.state);gt(s)?s.then(e):e(s)}getState(t){if(t&&(typeof t=="string"||typeof t=="function")){if(!this.getterCache[t]){let e;if(typeof t=="function"?e=t(this.state):e=(Array.isArray(t)?t:t.match(/([^[.\]])+/g)).reduce((s,r)=>s&&s[r],this.state),e==null)return;this.getterCache[t]=e}return this.getterCache[t]}}_processCallbacks(t){return!!this.callbacks.length&&(this.callbacks.forEach(e=>e(t)),!0)}subscribe(t){if(typeof t!="function")throw new Error("Dude, you can only subscribe to store changes with a valid function");return this.callbacks.includes(t)||this.callbacks.push(t),()=>{this.callbacks=this.callbacks.filter(e=>e!==t)}}_copyValue(t){return t&&JSON.parse(JSON.stringify(t))}clear(t=!0){this.getterCache={},this.transactionCache={},this.lastUpdatedState={},this.persist&&this.persist.removeState(),this.transaction=!0,this.status="clear";let e=this._copyValue(this.copyOfInitialState);for(let s in e)this.state[s]=e[s];this.transaction=!1,this.status="resting",t&&this._processCallbacks(this.state)}};function vt(i,t){let e=X(i);return e||(e=new H(t),globalThis.__ficusjs__=globalThis.__ficusjs__||{},globalThis.__ficusjs__.store=globalThis.__ficusjs__.store||{},globalThis.__ficusjs__.store[i]=e,e)}function X(i){if(globalThis.__ficusjs__&&globalThis.__ficusjs__.store&&globalThis.__ficusjs__.store[i])return globalThis.__ficusjs__.store[i]}function yt(i){return{...i,created(){if(i.state&&typeof i.state!="function")throw new Error("State must be a function!");this._state=i.state||{},typeof this._state=="function"&&(this._state=this._state.bind(this)()),this.state=this._monitorState(this._state),this.setState=(t,e)=>{let s=n=>{if(!n||typeof n!="object")return;let o=this.updated;e&&(this.updated=()=>{e(),this.updated=o||void 0}),this.status="transaction";for(let a in n)this.state[a]&&this.state[a]===n[a]||(this.state[a]=n[a]);this.status="render",this._processRender()},r=t(this.state);gt(r)?r.then(s):s(r)},i.created&&i.created.call(this)},_monitorState(t){let e=this;return new Proxy(t,{set:(s,r,n)=>(s[r]===n||(s[r]=n,e.computedCache={},e.status==="render"&&e._processRender()),!0)})}}}function St(i,t,e){let s={_xstateService:i,_getterCache:{},_persist:typeof e=="string"?O(e):e,get status(){return this._xstateService?this._xstateService.status:y.INIT},get state(){return this._xstateService.state},subscribe(r){return this._xstateService.subscribe(()=>{this._getterCache={},this._persist&&this._xstateService.status===y.RUNNING&&this._persist.setState(this._xstateService.state),r()})},send(r){this._xstateService.send(r)},start(){this._xstateService.start(this._persist?this._persist.getState():void 0)}};return t&&(s.getters=new Proxy(t,{get(r,n){if(!s._getterCache[n]){let o=r[n](s._xstateService.state.context);s._getterCache[n]=o}return s._getterCache[n]}})),s}var y=Object.freeze({INIT:-1,NOT_STARTED:0,RUNNING:1,STOPPED:2});function wt(i,t){return{...t,created(){this._subscribeCallback=()=>{this.computedCache={},this._processRender()},this.setXStateService(i),t.created&&t.created.call(this)},mounted(){this._subscribeToFsmService(!1),t.mounted&&t.mounted.call(this)},updated(){this._subscribeToFsmService(!1),t.updated&&t.updated.call(this)},removed(){this._unsubscribeFromFsmService(),t.removed&&t.removed.call(this)},setXStateService(e){this.fsm=e&&e.status!==y.INIT?e:St(e),this._fsmSubscriptionCallback=()=>{this.fsm.status===y.RUNNING&&this._fsmSubscription&&this._subscribeCallback()},this._subscribeToFsmService()},_startFsmService(){this.fsm&&this._fsmSubscription&&this.fsm.status===y.NOT_STARTED&&this.fsm.start()},_subscribeToFsmService(e=!0){this.fsm&&this.fsm.status!==y.INIT&&!this._fsmSubscription&&(this._fsmSubscription=this.fsm.subscribe(this._fsmSubscriptionCallback),e&&this._fsmSubscriptionCallback(),this._startFsmService())},_unsubscribeFromFsmService(){this.fsm&&this.fsm.status!==y.INIT&&this._fsmSubscription&&typeof this._fsmSubscription=="function"&&(this._fsmSubscription(),this._fsmSubscription=null)}}}function pt(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var s,r,n=e.call(i),o=[];try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)o.push(s.value)}catch(a){r={error:a}}finally{try{s&&!s.done&&(e=n.return)&&e.call(n)}finally{if(r)throw r.error}}return o}var w;(function(i){i[i.NotStarted=0]="NotStarted",i[i.Running=1]="Running",i[i.Stopped=2]="Stopped"})(w||(w={}));var Ct={type:"xstate.init"};function F(i){return i===void 0?[]:[].concat(i)}function Tt(i){return{type:"xstate.assign",assignment:i}}function dt(i,t){return typeof(i=typeof i=="string"&&t&&t[i]?t[i]:i)=="string"?{type:i}:typeof i=="function"?{type:i.name,exec:i}:i}function j(i){return function(t){return i===t}}function xt(i){return typeof i=="string"?{type:i}:i}function ft(i,t){return{value:i,context:t,actions:[],changed:!1,matches:j(i)}}function _t(i,t,e){var s=t,r=!1;return[i.filter(function(n){if(n.type==="xstate.assign"){r=!0;var o=Object.assign({},s);return typeof n.assignment=="function"?o=n.assignment(s,e):Object.keys(n.assignment).forEach(function(a){o[a]=typeof n.assignment[a]=="function"?n.assignment[a](s,e):n.assignment[a]}),s=o,!1}return!0}),s,r]}function jt(i,t){t===void 0&&(t={});var e=pt(_t(F(i.states[i.initial].entry).map(function(o){return dt(o,t.actions)}),i.context,Ct),2),s=e[0],r=e[1],n={config:i,_options:t,initialState:{value:i.initial,actions:s,context:r,matches:j(i.initial)},transition:function(o,a){var u,c,l=typeof o=="string"?{value:o,context:i.context}:o,h=l.value,p=l.context,f=xt(a),d=i.states[h];if(d.on){var m=F(d.on[f.type]);try{for(var b=function(_){var N=typeof Symbol=="function"&&Symbol.iterator,st=N&&_[N],rt=0;if(st)return st.call(_);if(_&&typeof _.length=="number")return{next:function(){return _&&rt>=_.length&&(_=void 0),{value:_&&_[rt++],done:!_}}};throw new TypeError(N?"Object is not iterable.":"Symbol.iterator is not defined.")}(m),g=b.next();!g.done;g=b.next()){var v=g.value;if(v===void 0)return ft(h,p);var P=typeof v=="string"?{target:v}:v,S=P.target,Q=P.actions,Y=Q===void 0?[]:Q,Z=P.cond,Bt=Z===void 0?function(){return!0}:Z,Dt=S===void 0,Ft=S??h,zt=i.states[Ft];if(Bt(p,f)){var A=pt(_t((Dt?F(Y):[].concat(d.exit,Y,zt.entry).filter(function(_){return _})).map(function(_){return dt(_,n._options.actions)}),p,f),3),tt=A[0],Ht=A[1],Xt=A[2],et=S??h;return{value:et,context:Ht,actions:tt,changed:S!==h||tt.length>0||Xt,matches:j(et)}}}}catch(_){u={error:_}}finally{try{g&&!g.done&&(c=b.return)&&c.call(b)}finally{if(u)throw u.error}}}return ft(h,p)}};return n}var bt=function(i,t){return i.actions.forEach(function(e){var s=e.exec;return s&&s(i.context,t)})};function Kt(i,t,e){return St(function(r){var n=r.initialState,o=w.NotStarted,a=new Set,u={_machine:r,send:function(c){o===w.Running&&(n=r.transition(n,c),bt(n,xt(c)),a.forEach(function(l){return l(n)}))},subscribe:function(c){return a.add(c),c(n),{unsubscribe:function(){return a.delete(c)}}},start:function(c){if(c){var l=typeof c=="object"?c:{context:r.config.context,value:c};n={value:l.value,actions:[],context:l.context,matches:j(l.value)}}else n=r.initialState;return o=w.Running,bt(n,Ct),u},stop:function(){return o=w.Stopped,a.clear(),u},get state(){return n},get status(){return o}};return u}(i),t,e)}function Ot(i,t,e,s){let r=Kt(t,e,s);return globalThis.__ficusjs__=globalThis.__ficusjs__||{},globalThis.__ficusjs__.xstate=globalThis.__ficusjs__.xstate||{},globalThis.__ficusjs__.xstate[i]=r,r}function Et(i,t){return globalThis.__ficusjs__=globalThis.__ficusjs__||{},globalThis.__ficusjs__.xstate=globalThis.__ficusjs__.xstate||{},globalThis.__ficusjs__.xstate[i]=t,t}function Rt(i){if(globalThis.__ficusjs__&&globalThis.__ficusjs__.xstate&&globalThis.__ficusjs__.xstate[i])return globalThis.__ficusjs__.xstate[i]}var ge={};qt(ge,{addMatcherToRoute:()=>D,addXStateService:()=>Et,assign:()=>Tt,createAppState:()=>vt,createCustomElement:()=>kt,createMachine:()=>jt,createPersist:()=>O,createXStateService:()=>Ot,getAppState:()=>X,getEventBus:()=>it,getI18n:()=>Pt,getRouter:()=>ht,getXStateService:()=>Rt,html:()=>W,renderer:()=>G,withI18n:()=>At,withLocalState:()=>yt,withStore:()=>mt,withXStateService:()=>wt});function E(i){return i.replace(/([A-Z])/g,"-$1").toLowerCase()}function Wt(i,t){for(;t.firstChild;)t.removeChild(t.firstChild);let e;if(typeof i=="string")e=document.createElement("div"),e.innerHTML=i;else{if(!i.nodeName)throw new Error(`Unable to render ${i}. Have you included a renderer function?`);e=i}e&&t.appendChild(e)}function kt(i,t){let e=function(s){if(!s)return[];let r=[];return Object.keys(s).forEach(n=>{(s[n].observed==null||s[n].observed)&&r.push(E(n))}),r}(t.props);globalThis.customElements.get(i)||globalThis.customElements.define(i,class extends globalThis.HTMLElement{static get observedAttributes(){return e}get componentTagName(){return i}connectedCallback(){this.connectedCallbackCount==null&&(this.connectedCallbackCount=0),this.connectedCallbackCount=this.connectedCallbackCount+1,this._checkInit(),this._preprocess()}disconnectedCallback(){typeof this.removed=="function"&&(this.removed(),this.isRemovedCalled=!0)}attributeChangedCallback(){this.connectedCallbackCount!=null&&(this._checkInit(),this._preprocess(),typeof this.propsDidUpdate=="function"&&this.isMountedCalled&&this.propsDidUpdate())}get initialised(){return this._props&&this._computed&&this.templateRenderer}_checkInit(){this.initialised||this._init(t)}_init(s){this.ficusCustomElement=i,this._props=s.props||{},this._computed=s.computed||{},this.computedCache={},this.status="render",this.connectedCallbackCount=0,this.props=this._processProps(),this.root=this._processRoot(s.root),this.slots=this._processSlots(),this.render=s.render||null,this.templateRenderer=s.renderer||Wt,this.template=null,this.created=s.created||null,this.mounted=s.mounted||null,this.updated=s.updated||null,this.removed=s.removed||null,this.propsDidUpdate=s.propsDidUpdate||null,this.isCreatedCalled=!1,this.isMountedCalled=!1,this.isRemovedCalled=!1,this.emit=(r,n)=>{(function(o,a,u={}){let c=Object.assign({},{bubbles:!0,cancelable:!0,composed:!1},u),l=globalThis.document.createEvent("CustomEvent");l.initCustomEvent(a,c.bubbles,c.cancelable,c.detail),Object.defineProperty(l,"composed",{value:c.composed}),o.dispatchEvent(l)})(this,r,{detail:n})},this._processMethodsAndComputedProps(s),this._processInstanceProps(this._props),typeof this.created!="function"||this.isCreatedCalled||(this.created(),this.isCreatedCalled=!0)}_processProps(){let s={};return Object.keys(this._props).forEach(r=>{let n={},o=this._props[r],a=this._getAttribute(r),u=null;if(o.default!=null&&(u=o.default),o.required&&a==null)u!=null?(console.info(`No biggie, the required prop '${r}' has no value set, so the default has been set`),n[r]=u):(n[r]=null,console.error(`The required prop '${r}' has no value set`));else switch(o.type){case String:default:n[r]=a||u;break;case Number:n[r]=a!=null?parseFloat(a):u??0;break;case Boolean:n[r]=a!=null?a.toString()==="true":u!=null&&u;break;case Object:try{n[r]=a!=null?JSON.parse(a):u??void 0}catch{n[r]=u??void 0,console.error(`An object prop parse issue occurred with prop ${r} and value ${a}`)}}s[r]=n[r],this._instanceProps&&this._instanceProps[r]&&(s[r]=this._instanceProps[r])}),s}_processMethodsAndComputedProps(s){let r=this,n=Object.keys(s);n.length&&n.forEach(o=>{r[o]||typeof s[o]!="function"||(r[o]=s[o].bind(r)),o==="computed"&&this._processComputed(s[o])})}_processRoot(s){switch(s){case"standard":default:return this;case"shadow":return this.attachShadow({mode:"open"});case"shadow:closed":return this.attachShadow({mode:"closed"})}}_processComputed(s){let r=this,n=Object.keys(s);n.length&&n.forEach(o=>{r[o]?console.warn(`Computed property '${o}' already exists on the component instance`):Object.defineProperty(r,o,{get:()=>(r.computedCache[o]||(r.computedCache[o]=s[o].bind(r)()),r.computedCache[o])})})}_processRender(){let s=this.render?this.render():void 0;s&&(this.template=s,this._updateRender())}_processSlots(){let s=this.childNodes,r={default:[]};return s.length>0&&[...s].forEach(n=>{let o=n.getAttribute?n.getAttribute("slot"):null;o?r[o]=n:r.default.push(n)}),r}_getAttribute(s){try{return this.getAttribute(E(s))}catch(r){return console.error("A get prop error occurred",r),""}}_processInstanceProps(s){let r=this,n=Object.keys(s);s&&n.forEach(o=>{let a;r[o]&&(a=r[o],delete r[o]),Object.defineProperty(r,o,{get(){return this._instanceProps&&this._instanceProps[o]?this._instanceProps[o]:this.getAttribute(E(o))},set(u){return this._instanceProps||(this._instanceProps={}),this._instanceProps[o]=u,this.setAttribute(E(o),typeof u=="object"?JSON.stringify(u):u.toString()),!0},enumerable:!0}),a&&(r[o]=a)})}_preprocess(){this.computedCache={},this.props=this._processProps(),this._processRender()}_updateRender(){var s;this.template&&(typeof(s=this.template)!="object"&&typeof s!="function"||typeof s.then!="function"?(this.templateRenderer(this.template,this.root),this._callLifecycleMethods()):this.template.then(r=>{this.templateRenderer(r,this.root),this._callLifecycleMethods()}).catch(r=>console.error("A component render error occurred",r)))}_callLifecycleMethods(){typeof this.mounted!="function"||this.isMountedCalled||this.mounted(),this.isMountedCalled=!0,typeof this.updated=="function"&&this.isMountedCalled&&this.updated()}})}var q=class{constructor(){if(globalThis.__ficusjs__&&globalThis.__ficusjs__.i18n)return globalThis.__ficusjs__.i18n;this.registry={},this.currentLocale="en",this.interpolateRE=/{{\s*(\w+)\s*}}/g,this.pluralizationRules={en:{pluralizeTo:"count",getVariationIndex:t=>t===1?0:1}},this._init(),globalThis.__ficusjs__=globalThis.__ficusjs__||{},globalThis.__ficusjs__.i18n=globalThis.__ficusjs__.i18n||this}_init(){if(typeof window<"u"&&typeof document<"u"){let t=new URLSearchParams(window.location.search).get("lang"),e=t||(document.documentElement.lang?document.documentElement.lang:navigator.language);e&&this.setLocale(e)}}_translatePlural(t,e,s,r,n){let o=this.pluralizationRules[r],a=Object.keys(s),u=a.length===1?a[0]:n||o.pluralizeTo,c=parseFloat(s[u]);if(isNaN(c))throw new Error(`Translation pluralization missing parameters on key '${t}'`);return this._interpolate(e[o.getVariationIndex(c)],s)}_interpolate(t,e){return e?t.replace(this.interpolateRE,function(s,r){return e[r]!=null?e[r]:s}):t}t(t,e,s){let r=(s=s||{}).locale||this.currentLocale,n=s.registry||this.registry,o=n[r]&&n[r][t];return o===void 0?this.whenUndefined(t,r):Array.isArray(o)?this._translatePlural(t,o,e,r,s.pluralizeTo):this._interpolate(o,e)}add(t,e,s){return e=e||this.currentLocale,this.registry[e]=this.registry[e]||{},Object.keys(t).forEach(r=>{let n=t[r],o=s?s+"."+r:r,a=typeof n;Array.isArray(n)||a==="string"||a==="number"?this.registry[e][o]=n:this.add(n,e,o)}),this}setLocale(t){return this.currentLocale=t,this}getLocale(){return this.currentLocale}interpolateWith(t){return this.interpolateRE=t,this}setPluralizationRule(t,e,s){return this.pluralizationRules[t]={pluralizeTo:s&&(s.pluralizeTo||"count"),getVariationIndex:e},this}whenUndefined(t,e){return t}clear(){return this.registry={},this}};function Gt(){return new q}function Pt(){return Gt()}function At(i,t){return{...t,created(){this.setI18n(i),t.created&&t.created.call(this)},setI18n(e){let s=this;s._i18n=e,s.i18n={t:(r,n,o)=>s._i18n.t(r,n,o),getLocale:()=>s._i18n.getLocale()}}}}var J=class extends Map{set(t,e){return super.set(t,e),e}},x=class extends WeakMap{set(t,e){return super.set(t,e),e}};var Qt=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,Yt=/<([a-z]+[a-z0-9:._-]*)([^>]*?)(\/?)>/g,Zt=/([^\s\\>"'=]+)\s*=\s*(['"]?)\x01/g,te=/[\x01\x02]/g,ee=(i,t)=>i.nodeType===111?1/t<0?t?(({firstChild:e,lastChild:s})=>{let r=document.createRange();return r.setStartAfter(e),r.setEndAfter(s),r.deleteContents(),e})(i):i.lastChild:t?i.valueOf():i.firstChild:i,{isArray:se}=Array,K=i=>i==null?i:i.valueOf(),Nt=(i,t)=>{let e,s,r=t.slice(2);return!(t in i)&&(s=t.toLowerCase())in i&&(r=s.slice(2)),n=>{let o=se(n)?n:[n,!1];e!==o[0]&&(e&&i.removeEventListener(r,e,o[1]),(e=o[0])&&i.addEventListener(r,e,o[1]))}},{isArray:$t,prototype:re}=Array,{indexOf:ie}=re,{createDocumentFragment:ne,createElement:oe,createElementNS:ae,createTextNode:ce,createTreeWalker:ue,importNode:le}=new Proxy(document,{get:(i,t)=>i[t].bind(i)}),R,he=(i,t)=>t?(e=>{R||(R=ae("http://www.w3.org/2000/svg","svg")),R.innerHTML=e;let s=ne();return s.append(...R.childNodes),s})(i):(e=>{let s=oe("template");return s.innerHTML=e,s.content})(i),pe=({childNodes:i},t)=>i[t],T=(i,t,e)=>((s,r,n,o,a)=>{let u=n.length,c=r.length,l=u,h=0,p=0,f=null;for(;h<c||p<l;)if(c===h){let d=l<u?p?o(n[p-1],-0).nextSibling:o(n[l-p],0):a;for(;p<l;)s.insertBefore(o(n[p++],1),d)}else if(l===p)for(;h<c;)f&&f.has(r[h])||s.removeChild(o(r[h],-1)),h++;else if(r[h]===n[p])h++,p++;else if(r[c-1]===n[l-1])c--,l--;else if(r[h]===n[l-1]&&n[p]===r[c-1]){let d=o(r[--c],-1).nextSibling;s.insertBefore(o(n[p++],1),o(r[h++],-1).nextSibling),s.insertBefore(o(n[--l],1),d),r[c]=n[l]}else{if(!f){f=new Map;let d=p;for(;d<l;)f.set(n[d],d++)}if(f.has(r[h])){let d=f.get(r[h]);if(p<d&&d<l){let m=h,b=1;for(;++m<c&&m<l&&f.get(r[m])===d+b;)b++;if(b>d-p){let g=o(r[h],0);for(;p<d;)s.insertBefore(o(n[p++],1),g)}else s.replaceChild(o(n[p++],1),o(r[h++],-1))}else h++}else s.removeChild(o(r[h++],-1))}return n})(i.parentNode,t,e,ee,i),de=(i,t)=>{switch(t[0]){case"?":return((e,s,r)=>n=>{let o=!!K(n);r!==o&&((r=o)?e.setAttribute(s,""):e.removeAttribute(s))})(i,t.slice(1),!1);case".":return((e,s)=>s==="dataset"?(({dataset:r})=>n=>{for(let o in n){let a=n[o];a==null?delete r[o]:r[o]=a}})(e):r=>{e[s]=r})(i,t.slice(1));case"@":return Nt(i,"on"+t.slice(1));case"o":if(t[1]==="n")return Nt(i,t)}switch(t){case"ref":return(e=>{let s;return r=>{s!==r&&(s=r,typeof r=="function"?r(e):r.current=e)}})(i);case"aria":return(e=>s=>{for(let r in s){let n=r==="role"?r:`aria-${r}`,o=s[r];o==null?e.removeAttribute(n):e.setAttribute(n,o)}})(i)}return((e,s)=>{let r,n=!0,o=document.createAttributeNS(null,s);return a=>{let u=K(a);r!==u&&((r=u)==null?n||(e.removeAttributeNode(o),n=!0):(o.value=u,n&&(e.setAttributeNodeNS(o),n=!1)))}})(i,t)};function fe(i){let{type:t,path:e}=i,s=e.reduceRight(pe,this);return t==="node"?(r=>{let n,o,a=[],u=c=>{switch(typeof c){case"string":case"number":case"boolean":n!==c&&(n=c,o||(o=ce("")),o.data=c,a=T(r,a,[o]));break;case"object":case"undefined":if(c==null){n!=c&&(n=c,a=T(r,a,[]));break}if($t(c)){n=c,c.length===0?a=T(r,a,[]):typeof c[0]=="object"?a=T(r,a,c):u(String(c));break}if(n!==c)if("ELEMENT_NODE"in c)n=c,a=T(r,a,c.nodeType===11?[...c.childNodes]:[c]);else{let l=c.valueOf();l!==c&&u(l)}break;case"function":u(c(r))}};return u})(s):t==="attr"?de(s,i.name):(r=>{let n;return o=>{let a=K(o);n!=a&&(n=a,r.textContent=a??"")}})(s)}var V=i=>{let t=[],{parentNode:e}=i;for(;e;)t.push(ie.call(e.childNodes,i)),i=e,{parentNode:e}=i;return t},Mt=new x,_e=/^(?:textarea|script|style|title|plaintext|xmp)$/,be=(i,t)=>{let e=i==="svg",s=((l,h,p)=>{let f=0;return l.join("").trim().replace(Yt,(d,m,b,g)=>{let v=m+b.replace(Zt,"=$2$1").trimEnd();return g.length&&(v+=p||Qt.test(m)?" /":"></"+m),"<"+v+">"}).replace(te,d=>d===""?"<!--"+h+f+++"-->":h+f++)})(t,"is\xB5",e),r=he(s,e),n=ue(r,129),o=[],a=t.length-1,u=0,c=`is\xB5${u}`;for(;u<a;){let l=n.nextNode();if(!l)throw`bad template: ${s}`;if(l.nodeType===8)l.data===c&&(o.push({type:"node",path:V(l)}),c="is\xB5"+ ++u);else{for(;l.hasAttribute(c);)o.push({type:"attr",path:V(l),name:l.getAttribute(c)}),l.removeAttribute(c),c="is\xB5"+ ++u;_e.test(l.localName)&&l.textContent.trim()===`<!--${c}-->`&&(l.textContent="",o.push({type:"text",path:V(l)}),c="is\xB5"+ ++u)}}return{content:r,nodes:o}},me=(i,t)=>{let{content:e,nodes:s}=Mt.get(t)||Mt.set(t,be(i,t)),r=le(e,!0);return{content:r,updates:s.map(fe,r)}},k=(i,{type:t,template:e,values:s})=>{let r=Lt(i,s),{entry:n}=i;n&&n.template===e&&n.type===t||(i.entry=n=((c,l)=>{let{content:h,updates:p}=me(c,l);return{type:c,template:l,content:h,updates:p,wire:null}})(t,e));let{content:o,updates:a,wire:u}=n;for(let c=0;c<r;c++)a[c](s[c]);return u||(n.wire=(c=>{let{firstChild:l,lastChild:h}=c;if(l===h)return h||c;let{childNodes:p}=c,f=[...p];return{ELEMENT_NODE:1,nodeType:111,firstChild:l,lastChild:h,valueOf:()=>(p.length!==f.length&&c.append(...f),c)}})(o))},Lt=({stack:i},t)=>{let{length:e}=t;for(let s=0;s<e;s++){let r=t[s];r instanceof C?t[s]=k(i[s]||(i[s]={stack:[],entry:null,wire:null}),r):$t(r)?Lt(i[s]||(i[s]={stack:[],entry:null,wire:null}),r):i[s]=null}return e<i.length&&i.splice(e),e},C=class{constructor(t,e,s){this.type=t,this.template=e,this.values=s}},Ut=i=>{let t=new x;return Object.assign((e,...s)=>new C(i,e,s),{for(e,s){let r=t.get(e)||t.set(e,new J);return r.get(s)||r.set(s,(n=>(o,...a)=>k(n,{type:i,template:o,values:a}))({stack:[],entry:null,wire:null}))},node:(e,...s)=>k({stack:[],entry:null,wire:null},new C(i,e,s)).valueOf()})},It=new x,W=Ut("html");function G(i,t){((e,s)=>{let r=typeof s=="function"?s():s,n=It.get(e)||It.set(e,{stack:[],entry:null,wire:null}),o=r instanceof C?k(n,r):r;o!==n.wire&&(n.wire=o,e.replaceChildren(o.valueOf()))})(t,i)}Ut("svg");var $e=Object.freeze({APP_CONFIG:"ficus.app.shell.appConfig",LAYOUT:"ficus.app.shell.layout"});export{it as a,D as b,ye as c,ht as d,O as e,vt as f,X as g,ge as h,$e as i};
/*! (c) Andrea Giammarchi - ISC */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
// FicusJS App Shell ES Module bundle | v0.1.0
//# sourceMappingURL=chunk-OVYBZV7R.js.map
